// Code generated by toucan, DO NOT EDIT.
package toucan

import models "github.com/endigma/toucan/_examples/basic/models"

// Global authorizer
type Authorizer struct {
	resolver Resolver
}

func (a Authorizer) Authorize(actor *models.User, permission string, resource any) bool {
	switch resource.(type) {
	case *models.Repository:
		return a.AuthorizeRepository(actor, permission, resource.(*models.Repository))
	case *models.User:
		return a.AuthorizeUser(actor, permission, resource.(*models.User))
	default:
		return false
	}
}

func NewAuthorizer(resolver Resolver) Authorizer {
	return Authorizer{resolver: resolver}
}
